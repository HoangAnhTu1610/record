(()=>{const e=".present-single-question__head fieldset legend",t=".present-single-question__head fieldset div",n=".present-single-question__body .mdc-form-field",o=".present-single-question__head fieldset img",r=".assignment > div > div:nth-child(3)";let[c,i,s,l]=[[],[],[],[]];const[a,d,u]=[{},new Set,[]],h=["A. ","B. ","C. ","D. "];function g(e){return e.normalize("NFKC").replace(/\s+/g," ").trim()}async function m(e){const t=e.split("/").pop(),n=u.find((e=>e.name===t));if(n)return n.src;try{const n=await fetch(e);if(!n.ok)throw new Error("M\u1ea5t k\u1ebft n\u1ed1i");const o=await n.blob(),r=new FormData;r.append("blob",o);const c=await fetch("https://api.luusytruong.id.vn/lms/temp.php",{method:"POST",body:r});if(!c.ok)throw new Error("M\u1ea5t k\u1ebft n\u1ed1i");const i=await c.json();if(i.src)return u.push({name:t,src:i.src}),console.log("th\xe0nh c\xf4ng"),i.src;throw new Error(`L\u1ed7i: ${i}`)}catch(o){return console.error(o),{error:!0}}}function f(e){const t=e.target,n=parseInt(t.dataset.index,10);"radio"===(null===t||void 0===t?void 0:t.type)?(d.clear(),d.add(n)):null!==t&&void 0!==t&&t.checked?d.add(n):d.delete(n),async function(){if(i.length<4)return;for(let e=0;e<i.length;e++){var t;const n=null!==(t=i[e])&&void 0!==t?t:s[e];n&&(c[e]=(d.has(e)?`*${h[e]}`:h[e])+n)}l[a.no-1]={...a,options:c,select:Array.from(d)},await async function(t,n){try{"undefined"!==typeof chrome&&chrome.storage?chrome.storage.local.set({[t]:n},(()=>{console.log(`L\u01b0u th\xe0nh c\xf4ng v\u1edbi key: ${t}`)})):console.error("L\u1ed7i: kh\xf4ng ph\u1ea3i m\xf4i tr\u01b0\u1eddng extension")}catch(e){console.error("handle save: "+e.message)}}("test",l)}()}async function v(r){if(!r)return;const l=await y("auto"),u=new Set(l),h=document.querySelectorAll(n),v=document.querySelector(t),p=document.querySelector(e),w=document.querySelector(o);d.clear(),[c,i,s]=[[],[],[]],a.img_src="",v&&(a.text=g(v.innerText)),p&&(a.no=parseInt(p.innerText.replace(/\D/g,""))),w&&await new Promise((e=>{const t=setInterval((async()=>{w.src.includes("blob")&&(clearInterval(t),a.img_src=await m(w.src),e())}),100)}));for(let e=0;e<h.length;e++){const t=h[e].querySelector("input"),n=h[e].querySelector("label"),o=h[e].querySelector("img");if(t&&(t.dataset.index=e,t.removeEventListener("click",f),t.addEventListener("click",f)),n&&""!==n.innerText){const t=g(n.innerText),o=g(a.text+" "+t).toLowerCase();if(i[e]=t,r&&u.has(o)){n.classList.add("selected-hehe");const e=setInterval((()=>{i.length<4||(clearInterval(e),n.click())}),10)}}else if(o){const t=await m(o.src);s[e]={type:"img",src:t}}}console.log("%ccall select","color: #00AA00; font-size: 20px")}async function y(e){if("undefined"!==typeof chrome||chrome.storage)return new Promise(((t,n)=>{try{chrome.storage.local.get([e],(n=>{n[e]?(console.log(`L\u1ea5y th\xe0nh c\xf4ng v\u1edbi key: ${e}`),t(n[e])):(console.log(`L\u1ea5y th\u1ea5t b\u1ea1i v\u1edbi key: ${e}`),t([]))}))}catch(o){console.error("handle Get: "+o.message),n(o)}}));console.error("L\u1ed7i: kh\xf4ng ph\u1ea3i m\xf4i tr\u01b0\u1eddng extension")}console.clear(),window.location.href.includes("lms.ictu.edu.vn")&&(!async function(){const e=await y("settings"),t=document.querySelector(".app-version");null!==e&&void 0!==e&&e.toggle&&(t&&t.addEventListener("click",(()=>{v(null===e||void 0===e?void 0:e.auto)})),function(e){const t=()=>{t.debouncing||(t.debouncing=!0,setTimeout((()=>{v(e),t.debouncing=!1}),100))};setInterval((()=>{const e=document.querySelector(r);e&&(console.log("\u0111\xe3 t\xecm th\u1ea5y"),e.removeEventListener("click",t),e.addEventListener("click",t))}),1e3)}(null===e||void 0===e?void 0:e.auto))}(),window.addEventListener("contextmenu",(function(e){e.stopPropagation()}),!0))})();
//# sourceMappingURL=content.js.map