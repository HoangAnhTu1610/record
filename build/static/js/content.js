(()=>{const e=".present-single-question__head fieldset legend",t=".present-single-question__head fieldset div",n=".present-single-question__body .mdc-form-field",o=".present-single-question__head fieldset img",r="button",c="C\xe2u h\u1ecfi ti\u1ebfp theo",i="font-size: 20px; color:#39C134; font-family: Inter";let[s,a,l,d]=[[],[],[],[]];const[u,h,g]=[{},new Set,[]],m=["A. ","B. ","C. ","D. "];function f(e){return e.normalize("NFKC").replace(/\s+/g," ").trim()}async function p(e){const t=e.split("/").pop(),n=g.find((e=>e.name===t));if(n)return n.src;try{const n=await fetch(e);if(!n.ok)throw new Error("M\u1ea5t k\u1ebft n\u1ed1i");const o=await n.blob(),r=new FormData;r.append("blob",o);const c=await fetch("https://luusytruong.id.vn/api/lms/temp.php",{method:"POST",body:r});if(!c.ok)throw new Error("M\u1ea5t k\u1ebft n\u1ed1i");const i=await c.json();if(i.src)return g.push({name:t,src:i.src}),console.log("up load th\xe0nh c\xf4ng"),i.src;throw new Error(`L\u1ed7i: ${i}`)}catch(o){return console.error(o),{error:!0}}}function y(e){const t=e.target,n=parseInt(t.dataset.index,10);"radio"===(null===t||void 0===t?void 0:t.type)?(h.clear(),h.add(n)):null!==t&&void 0!==t&&t.checked?h.add(n):h.delete(n),async function(){for(let e=0;e<a.length;e++){var t;const n=null!==(t=a[e])&&void 0!==t?t:l[e];n&&(s[e]=(h.has(e)?`*${m[e]}`:m[e])+n)}d[u.no-1]={...u,options:s,select:Array.from(h)},await async function(t,n){if("undefined"===typeof chrome||!chrome.storage)return console.error("L\u1ed7i: kh\xf4ng ph\u1ea3i m\xf4i tr\u01b0\u1eddng extension"),!1;try{const e=await new Promise(((e,o)=>{chrome.storage.local.set({[t]:n},(()=>{const t=chrome.runtime.lastError;t?(console.error(`L\u1ed7i storage: ${t.message}`),o(t)):e(!0)}))}));return console.log(`L\u01b0u th\xe0nh c\xf4ng v\u1edbi key: ${t}`),e}catch(e){return console.error(`L\u1ed7i khi thao t\xe1c storage - ${t}:`,e.message),!1}}("test",d)}()}async function w(r){const c=await v("auto"),d=new Set(c),g=document.querySelectorAll(n),m=document.querySelector(t),w=document.querySelector(e),k=document.querySelector(o);h.clear(),[s,a,l]=[[],[],[]],u.img_src="",m&&(u.text=m.innerText.normalize("NFKC").trim()),w&&(u.no=parseInt(w.innerText.replace(/\D/g,""))),k&&await new Promise((e=>{const t=setInterval((async()=>{k.src.includes("blob")&&(clearInterval(t),u.img_src=await p(k.src),e())}),10)}));for(let e=0;e<g.length;e++){const t=g[e].querySelector("input"),n=g[e].querySelector("label"),o=g[e].querySelector("img");if(t&&(t.dataset.index=e,t.removeEventListener("click",y),t.addEventListener("click",y)),n&&""!==n.innerText){const t=f(n.innerText),o=f(u.text+" "+t).toLowerCase();if(a[e]=t,r&&d.has(o)){const e=setInterval((()=>{a.length<g.length||(clearInterval(e),n.classList.add("selected-hehe"),n.click())}),10)}}else if(o){const t=await p(o.src);l[e]={type:"img",src:t}}}console.log("%c\ud83d\udfe9 T\u1ea3i c\xe2u h\u1ecfi",i)}async function v(e){if("undefined"===typeof chrome||!chrome.storage)return console.error("L\u1ed7i: kh\xf4ng ph\u1ea3i m\xf4i tr\u01b0\u1eddng extension"),null;try{const t=await new Promise(((t,n)=>{chrome.storage.local.get([e],(o=>{const r=chrome.runtime.lastError;r?(console.error(`L\u1ed7i storage: ${r.message}`),n(r)):t(o[e]||null)}))}));return console.log(`L\u1ea5y th\xe0nh c\xf4ng v\u1edbi key: ${e}`),t}catch(t){return console.error(`L\u1ed7i khi thao t\xe1c storage - ${e}:`,t.message),null}}const k=window.location.href;(k.includes("lms.ictu.edu.vn")||k.startsWith("file"))&&(!async function(){const e=await v("settings"),t=document.querySelector(".app-version");null!==e&&void 0!==e&&e.toggle&&(t&&t.addEventListener("click",(()=>{w(null===e||void 0===e?void 0:e.auto)})),function(e){const t=()=>{t.debouncing||(t.debouncing=!0,setTimeout((()=>{w(e),t.debouncing=!1}),100))};setInterval((()=>{const n=Array.from(document.querySelectorAll(r)).find((e=>e.label===c||e.innerText.trim()===c));n&&!n.dataset.event&&(n.dataset.event=!0,console.log("%c\ud83d\udfe9 \u0110\xe3 th\u1ea5y n\xfat",i),n.addEventListener("click",t),w(e))}),1e3)}(null===e||void 0===e?void 0:e.auto))}(),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&"c"===e.key){const e=window.getSelection().toString();e&&navigator.clipboard.writeText(e).catch((e=>{console.error("Kh\xf4ng th\u1ec3 sao ch\xe9p:",e)}))}})),console.clear(),window.addEventListener("contextmenu",(function(e){e.stopPropagation()}),!0))})();
//# sourceMappingURL=content.js.map