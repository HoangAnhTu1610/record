{"version":3,"file":"static/js/content.js","mappings":"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","sources":["content/content.js"],"sourcesContent":["const query = {\r\n  number: \".present-single-question__head fieldset legend\",\r\n  question: \".present-single-question__head fieldset div\",\r\n  group: \".present-single-question__body .mdc-form-field\",\r\n  image: \".present-single-question__head fieldset img\",\r\n  btns: \"button\",\r\n  label: \"C√¢u h·ªèi ti·∫øp theo\",\r\n  avatar: \".user-avatar\",\r\n};\r\nconst style = \"font-size: 20px; color:#39C134; font-family: Inter\";\r\nlet [finalAnswer, groupAnswer, groupImgs, test] = [[], [], [], []];\r\nconst [question, select, cachedImgs] = [{}, new Set(), []];\r\nconst url = \"https://luusytruong.id.vn/api/lms/temp.php\";\r\nconst label = [\"A. \", \"B. \", \"C. \", \"D. \"];\r\n\r\nfunction normal(str) {\r\n  return str.normalize(\"NFKC\").replace(/\\s+/g, \" \").trim();\r\n}\r\n\r\nfunction standard(str) {\r\n  return str.normalize(\"NFKC\").trim();\r\n}\r\n\r\nasync function handleUpload(blobUrl) {\r\n  const fileName = blobUrl.split(\"/\").pop();\r\n  const existFile = cachedImgs.find((img) => img.name === fileName);\r\n  if (existFile) return existFile.src;\r\n\r\n  try {\r\n    const responseBlob = await fetch(blobUrl);\r\n    if (!responseBlob.ok) throw new Error(\"M·∫•t k·∫øt n·ªëi\");\r\n    const blob = await responseBlob.blob();\r\n    const formData = new FormData();\r\n    formData.append(\"blob\", blob);\r\n\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      body: formData,\r\n    });\r\n    if (!response.ok) throw new Error(\"M·∫•t k·∫øt n·ªëi\");\r\n    const result = await response.json();\r\n    if (result.src) {\r\n      cachedImgs.push({ name: fileName, src: result.src });\r\n      console.log(\"up load th√†nh c√¥ng\");\r\n      return result.src;\r\n    }\r\n    throw new Error(`L·ªói: ${result}`);\r\n  } catch (e) {\r\n    console.error(e);\r\n    return { error: true };\r\n  }\r\n}\r\n\r\nfunction handleChange(e) {\r\n  const elem = e.target;\r\n  const i = parseInt(elem.dataset.index, 10);\r\n  if (elem?.type === \"radio\") {\r\n    select.clear();\r\n    select.add(i);\r\n  } else {\r\n    elem?.checked ? select.add(i) : select.delete(i);\r\n  }\r\n  handleBuild();\r\n}\r\n\r\nasync function handleSelect(auto) {\r\n  const data = await handleGet(\"auto\");\r\n  const autoData = new Set(data);\r\n  const groups = document.querySelectorAll(query.group);\r\n  const questionElem = document.querySelector(query.question);\r\n  const numberElem = document.querySelector(query.number);\r\n  const imgElem = document.querySelector(query.image);\r\n\r\n  select.clear();\r\n  [finalAnswer, groupAnswer, groupImgs] = [[], [], []];\r\n  question.img_src = \"\";\r\n\r\n  if (questionElem) {\r\n    question.text = standard(questionElem.innerText);\r\n  }\r\n  if (numberElem) {\r\n    question.no = parseInt(numberElem.innerText.replace(/\\D/g, \"\"));\r\n  }\r\n  if (imgElem) {\r\n    await new Promise((resolve) => {\r\n      const interval = setInterval(async () => {\r\n        if (!imgElem.src.includes(\"blob\")) return;\r\n        clearInterval(interval);\r\n        question.img_src = await handleUpload(imgElem.src);\r\n        resolve();\r\n      }, 10);\r\n    });\r\n  }\r\n\r\n  for (let i = 0; i < groups.length; i++) {\r\n    const input = groups[i].querySelector(\"input\");\r\n    const label = groups[i].querySelector(\"label\");\r\n    const image = groups[i].querySelector(\"img\");\r\n\r\n    if (input) {\r\n      input.dataset.index = i;\r\n      input.removeEventListener(\"click\", handleChange);\r\n      input.addEventListener(\"click\", handleChange);\r\n    }\r\n    if (label && label.innerText !== \"\") {\r\n      const ans = normal(label.innerText);\r\n      const key = normal(question.text + \" \" + ans).toLowerCase();\r\n      groupAnswer[i] = ans;\r\n      if (auto && autoData.has(key)) {\r\n        const interval = setInterval(() => {\r\n          if (groupAnswer.length < groups.length) return;\r\n          clearInterval(interval);\r\n          label.classList.add(\"selected-hehe\");\r\n          label.click();\r\n        }, 10);\r\n      }\r\n    } else if (image) {\r\n      const src = await handleUpload(image.src);\r\n      groupImgs[i] = { type: \"img\", src: src };\r\n    }\r\n  }\r\n\r\n  console.log(\"%cüü© T·∫£i c√¢u h·ªèi\", style);\r\n}\r\n\r\nasync function handleBuild() {\r\n  for (let i = 0; i < groupAnswer.length; i++) {\r\n    const value = groupAnswer[i] ?? groupImgs[i];\r\n    if (value) {\r\n      finalAnswer[i] = (select.has(i) ? `*${label[i]}` : label[i]) + value;\r\n    }\r\n  }\r\n  test[question.no - 1] = {\r\n    ...question,\r\n    options: finalAnswer,\r\n    select: Array.from(select),\r\n  };\r\n  await handleSet(\"test\", test);\r\n}\r\n\r\nasync function handleSet(key, data) {\r\n  if (typeof chrome === \"undefined\" || !chrome.storage) {\r\n    console.error(\"L·ªói: kh√¥ng ph·∫£i m√¥i tr∆∞·ªùng extension\");\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const result = await new Promise((resolve, reject) => {\r\n      chrome.storage.local.set({ [key]: data }, () => {\r\n        const error = chrome.runtime.lastError;\r\n        if (error) {\r\n          console.error(`L·ªói storage: ${error.message}`);\r\n          reject(error);\r\n        } else {\r\n          resolve(true);\r\n        }\r\n      });\r\n    });\r\n\r\n    console.log(`L∆∞u th√†nh c√¥ng v·ªõi key: ${key}`);\r\n    return result;\r\n  } catch (e) {\r\n    console.error(`L·ªói khi thao t√°c storage - ${key}:`, e.message);\r\n    return false;\r\n  }\r\n}\r\n\r\nasync function handleGet(key) {\r\n  if (typeof chrome === \"undefined\" || !chrome.storage) {\r\n    console.error(\"L·ªói: kh√¥ng ph·∫£i m√¥i tr∆∞·ªùng extension\");\r\n    return null;\r\n  }\r\n\r\n  try {\r\n    const result = await new Promise((resolve, reject) => {\r\n      chrome.storage.local.get([key], (result) => {\r\n        const error = chrome.runtime.lastError;\r\n        if (error) {\r\n          console.error(`L·ªói storage: ${error.message}`);\r\n          reject(error);\r\n        } else {\r\n          resolve(result[key] || null);\r\n        }\r\n      });\r\n    });\r\n\r\n    console.log(`L·∫•y th√†nh c√¥ng v·ªõi key: ${key}`);\r\n    return result;\r\n  } catch (e) {\r\n    console.error(`L·ªói khi thao t√°c storage - ${key}:`, e.message);\r\n    return null;\r\n  }\r\n}\r\n\r\nasync function handleToggle() {\r\n  const setting = await handleGet(\"settings\");\r\n  const versionLabel = document.querySelector(\".app-version\");\r\n\r\n  if (!setting?.toggle) return;\r\n  if (versionLabel) {\r\n    versionLabel.addEventListener(\"click\", () => {\r\n      handleSelect(setting?.auto);\r\n    });\r\n  }\r\n  handleAddEvent(setting?.auto);\r\n}\r\n\r\nfunction handleAddEvent(auto) {\r\n  const handleClick = () => {\r\n    if (handleClick.debouncing) return;\r\n    handleClick.debouncing = true;\r\n    setTimeout(() => {\r\n      handleSelect(auto);\r\n      handleClick.debouncing = false;\r\n    }, 100);\r\n  };\r\n\r\n  setInterval(() => {\r\n    const btns = Array.from(document.querySelectorAll(query.btns));\r\n    const btn = btns.find(\r\n      (btn) => btn.label === query.label || btn.innerText.trim() === query.label\r\n    );\r\n\r\n    if (btn && !btn.dataset.event) {\r\n      btn.dataset.event = true;\r\n      console.log(\"%cüü© ƒê√£ th·∫•y n√∫t\", style);\r\n      btn.addEventListener(\"click\", handleClick);\r\n      handleSelect(auto);\r\n    }\r\n  }, 1000);\r\n}\r\n\r\nfunction enableCopy() {\r\n  document.addEventListener(\"keydown\", (event) => {\r\n    if (event.ctrlKey && event.key === \"c\") {\r\n      const selection = window.getSelection().toString();\r\n      if (selection) {\r\n        navigator.clipboard.writeText(selection).catch((err) => {\r\n          console.error(\"Kh√¥ng th·ªÉ sao ch√©p:\", err);\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nconst href = window.location.href;\r\nif (href.includes(\"lms.ictu.edu.vn\") || href.startsWith(\"file\")) {\r\n  handleToggle();\r\n  enableCopy();\r\n  console.clear();\r\n  window.addEventListener(\r\n    \"contextmenu\",\r\n    function (e) {\r\n      e.stopPropagation();\r\n    },\r\n    true\r\n  );\r\n}\r\n"],"names":["query","style","finalAnswer","groupAnswer","groupImgs","test","question","select","cachedImgs","Set","label","normal","str","normalize","replace","trim","async","handleUpload","blobUrl","fileName","split","pop","existFile","find","img","name","src","responseBlob","fetch","ok","Error","blob","formData","FormData","append","response","method","body","result","json","push","console","log","e","error","handleChange","elem","target","i","parseInt","dataset","index","type","clear","add","checked","delete","length","_groupAnswer$i","value","has","no","options","Array","from","key","data","chrome","storage","Promise","resolve","reject","local","set","runtime","lastError","message","handleSet","handleBuild","handleSelect","auto","handleGet","autoData","groups","document","querySelectorAll","questionElem","querySelector","numberElem","imgElem","img_src","text","innerText","interval","setInterval","includes","clearInterval","input","image","removeEventListener","addEventListener","ans","toLowerCase","classList","click","get","href","window","location","startsWith","setting","versionLabel","toggle","handleClick","debouncing","setTimeout","btn","event","handleAddEvent","handleToggle","ctrlKey","selection","getSelection","toString","navigator","clipboard","writeText","catch","err","stopPropagation"],"sourceRoot":""}